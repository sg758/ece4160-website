<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="UTF-8">

    <!-- Begin Jekyll SEO tag v2.8.0 -->
    <title>Sugam's ECE 4160 Website | Lab 5</title>
    <meta name="generator" content="Jekyll v3.9.2"/>
    <meta property="og:title" content="Sugam Gautam's ECE 4160 Website"/>
    <meta property="og:locale" content="en_US"/>
    <link rel="canonical" href="https://sg758.github.io/ece4160-website/"/>
    <meta property="og:url" content="https://sg758.github.io/ece4160-website/"/>
    <meta property="og:site_name" content="ece4160-website"/>
    <meta property="og:type" content="website"/>
    <meta name="twitter:card" content="summary"/>
    <meta property="twitter:title" content="Sugam Gautam's ECE 4160 Website"/>
    <script type="application/ld+json">
        {
            "@context":"https://schema.org",
            "@type":"WebSite",
            "headline":"Sugam Gautam's ECE 4160 Website",
            "name":"ece4160-website",
            "url":"https://sg758.github.io/ece4160-website/"
        }
    </script>
    <!-- End Jekyll SEO tag -->

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;700&display=swap" as="style" type="text/css" crossorigin>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="stylesheet" href="/ece4160-website/assets/css/style.css">
    <!-- <link rel="shortcut icon" type="image/x-icon" href="/ece4160-website/assets/images/favicon.png"> -->
</head>

<body>
    <a id="skip-to-content" href="#content">Skip to the content.</a>

    <header class="page-header" role="banner">
        <h1 class="project-name">
            <a href="/ece4160-website/">ECE 4160 - Fast Robots (SP23)</a>
        </h1>
        <h2 class="project-tagline">Sugam Gautam</h2>
        <a href="https://github.com/sg758/ece4160-website" class="btn" id="view-on-github">View on GitHub</a>
    </header>

    <main id="content" class="main-content" role="main">
        <div id="navigation">
            <a href="/ece4160-website/" class="btn">Home</a>
            <a href="/ece4160-website/labs/lab1.html" class="btn">Lab 1</a>
            <a href="/ece4160-website/labs/lab2.html" class="btn">Lab 2</a>
            <a href="/ece4160-website/labs/lab3.html" class="btn">Lab 3</a>
            <a href="/ece4160-website/labs/lab4.html" class="btn">Lab 4</a>
            <a href="/ece4160-website/labs/lab5.html" class="btn" id="current">Lab 5</a>
            <a href="/ece4160-website/labs/lab6.html" class="btn">Lab 6</a>
        </div>

        <h1>Introduction</h1>
            <p>
                The purpose of Lab 5 was to control the RC car using the Artemis directly,
                using the newly added dual motor drivers. By the end of the lab, the car can
                execute a set of pre-programmed moves including turns.
            </p>

        <h1>Prelab</h1>
            <p>
                Before coming to the lab, there were a few things to consider. Firstly, I considered
                the pins that I would use to connect the motor drivers to. Given that they require
                PWM signals, the pin would have to be labeled with a "~" in the datasheet. Also,
                taking into consideration how they would be oriented to allow for easier 
                connections, I decided to connect the motor drivers as can be seen in the image
                below, where the left and right motor drivers are on either side of the Artemis
                board.
            </p>
            <figure id="figure1">
                <img src="/ece4160-website/assets/images/lab5/wiring.jpg"
                alt="Connection of motor drivers to Artemis">
            </figure>
            
            <p>
                For the left motor, I decided to connect <samp>IN1</samp> and <samp>IN2</samp> to
                A15 and A16, respectively. For the right motor, I decided to connect them to A1 and
                A0, respectively. The <samp>OUT1</samp> for both drivers would be connected to the
                negative of the motor and the <samp>OUT2</samp> to the positive. Finally, all of
                the grounds would be connected, ensuring common ground among all, and the
                <samp>VIN</samp> for both drivers would be connected to the motor battery's
                positive.
            </p>

            <p>
                Additionally, the Artemis and the motor drivers are to be powered using different
                batteries. This is because the motors connected to the motor drivers draw a lot of
                current, while the Artemis does not. Hence, the 850mAh battery is used for the motor
                drivers, and the 650mAh battery is used for the Artemis.
            </p>

            <p>
                Finally, the last consideration was for routing the variety of wires. As seen in
                <a href="/ece4160-website/labs/lab5.html#figure1">Figure 1</a>,
                there are about 13 wires that need to be long enough to reach other components.
                Given the scope of this lab, I decided that it would be fine to have long wires, as
                long as they are not unnecessarily long to cause considerable noise, as it would
                make the connections easier, and there would be no requirement to desolder and
                resolder the wires in the case of a wire not reaching a component. Also, taking
                inspiration from
                <a href="https://anyafp.github.io/ece4960/labs/lab5/#prelab">Anya's report</a>,
                I decided to twist the wires with each other to cancel out the positive and negative
                magnetic fields. Furthermore, given that solid core wires can cause problems when
                undergoing high accelerations, I decided to use stranded wire for all connections.
            </p>

        <h1>Lab Tasks</h1>
            <h2>First Dual Motor Driver</h2>
                <p>
                    I started by soldering all of the wires to the motor driver. After soldering,
                    here is what it looked like.
                </p>
                <figure id="figure2">
                    <img src="/ece4160-website/assets/images/lab5/motordriver1.jpg"
                    alt="Wires soldered to motor driver">
                </figure>

                <p>
                    Unfortunately, due to timing constraints, I was unable to go to the lab to take
                    oscilloscope measurements for the PWM signals. However, if I were to have had
                    time, I would have chosen the power supply voltage to be 3.7V, as this is equal
                    to the voltage output of the motor battery, and current to be 2A, to be well
                    below the maximum rating.
                </p>
            
            <h2><samp>analogWrite</samp></h2>
                <p>
                    As mentioned above, I was unable to go to lab to get the oscilloscope
                    measurements. However, taking a look at my classmates reports, it seems that
                    the waveform for a 50% duty cycle signal has the following shape.
                </p>
                <figure id="figure3">
                    <img src="/ece4160-website/assets/images/lab5/PWMsignal.jpg"
                    alt="Waveform of PWM signal output from Artemis">
                </figure>
            
            <h2>Taking the Car Apart</h2>
                <p>
                    The next step was to take apart the RC car and connect one of its motors to the
                    motor driver. After connecting the motor driver to the motor, the RC car looks
                    like the following.
                </p>
                <figure id="figure4">
                    <img src="/ece4160-website/assets/images/lab5/apartCar.jpg"
                    alt="Picture of RC car taken apart with motor connected to motor driver">
                </figure>
            
            <h2>Free Running the Motors</h2>
                <p>
                    After connecting the motor drivers and Artemis to the RC car, the video in
                    <a href="/ece4160-website/assets/images/lab5/lab5.html#figure5">Figure 5</a>
                    shows how I ran the motor on one side of the car using the following code.
                </p>

                <script
                    src="https://gist.github.com/sg758/d5332b5ee4955f7b667a002dcf19e0b2.js">
                </script>
                
                <figure id="figure5">
                    <video width="100%" controls loop>
                        <source src="/ece4160-website/assets/videos/lab5/leftMotor.mp4"
                        type="video/mp4">
                    </video>
                </figure>
        
            <h2>Powering Motor Drivers with 850mAh Battery</h2>
                <p>
                    Since I was unable to go to the lab, I have already been using the 850mAh
                    battery to power the motor drivers. I made sure to connect the positive and
                    negative terminals correctly, as well as to connect everything to ground and
                    there were no issues so far.
                </p>
        
            <h2>Second Dual Motor Drivers</h2>
                <p>
                    The second dual motor driver is where I ran into an issue. I was soldering
                    the wires to the motor controller at home, and initially, everything was fine.
                    However, as I soldered more and more, the soldering iron seemed to perform
                    more and more worse, until it was very difficult for the solder to attach to
                    the solder pads on the through-holes. When soldering the wires to the second
                    motor controller, I could not get the solder to stay and attach the wires
                    to the controller correctly, no matter how long I heated up the soldering iron
                    or placed its tip on the soldering pad. Hence, I was unable to get the second
                    motor driver connected to the RC car and the Artemis. But, given the
                    <a href="/ece4160-website/assets/images/lab5/lab5.html#figure1">
                        wiring diagram
                    </a>,
                    I would have connected the second motor driver to pins A0 and A1 on the Artemis,
                    and would have ran the following code for the wheels other side of the car to
                    rotate back and forth.
                </p>

                <script
                    src="https://gist.github.com/sg758/6442b229d2e327331ce669f64864fc22.js">
                </script>
        
            <h2>Full Installation</h2>
                <p>
                    After experimenting with one of the motor drivers, I would have placed the motor
                    drivers on the underside of the motor battery holder, and placed the Artemis and
                    its battery in the large space in front of the motors. I would have placed the
                    ToF sensors in the front of the car, each angled a little to the left and right.
                    Finally, the IMU would be placed on the underside of the battery holder, so that
                    it stays flat for accurate measurements.
                </p>
        
            <h2>PWM Discussion</h2>
                <p>
                    Taking a look at the classmates observations, it seems that the lower limit of
                    the PWM value in <samp>analogWrite(pin, PWM)</samp> was between 40 and 60. It
                    makes sense, as the motor driver is very likely keeping a threshold to be
                    robust against noise that could perhaps cause a 0-signal to appear up to 40, and
                    be mistaked for moving the motors.
                </p>
        
            <h2>Calibration</h2>
                <p>
                    If my robot did not travel in a straight line, I would have experimented with
                    multiplying one of the sides' PWM value by a factor to make it so that they
                    both travel at the same rate, and thus keep the robot moving in a straight line.
                    I would do this using the following code, changing the <samp>factor</samp>
                    constant to one that works well.
                </p>

                <script
                    src="https://gist.github.com/sg758/966c47e438ab1929a9efafde9348af91.js">
                </script>

            <h2>Open Loop Control of Robot</h2>
                <p>
                    Since I was unable to use the second motor driver, I cannot show a video of the
                    robot performing the open loop control. However, I would have used the
                    following code to move the robot forward for 2 seconds, turn right 90 deg, move
                    forward 2 seconds, turn left 90 deg, and move forward 2 seconds in a loop.
                </p>

                <script
                    src="https://gist.github.com/sg758/cb1daa7630ff2edd12d12d890613cdd0.js">
                </script>

        <footer class="site-footer">
            <span class="site-footer-owner">
                This site is maintained by
                <a href="https://github.com/sg758">Sugam Gautam</a>.
            </span>
            <span class="site-footer-credits">
                Hosted on
                <a href="https://pages.github.com">GitHub Pages</a>
                — Adapted from
                <a href="https://jasonlong.github.io/cayman-theme/">Cayman</a>
                theme by
                <a href="https://twitter.com/jasonlong">Jason Long</a>
                using the
                <a href="https://draculatheme.com/">Dracula</a>
                color palette.
            </span>
        </footer>
    </main>
</body>

</html>